<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Produtividade</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f2f2f2; text-align: center; }
        .container { max-width: 900px; margin: 50px auto; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        input, button { padding: 10px; margin: 10px; }
        .table-container { max-height: 400px; overflow-y: auto; margin-top: 20px; border: 1px solid #ddd; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px; border: 1px solid #ddd; }
        th { background-color: #333; color: white; }
        .setor { font-weight: bold; font-size: 18px; margin-top: 20px; color: #D52B1E; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Painel de Produtividade por Setor</h2>
        <input type="file" id="upload" accept=".xlsx">
        <div id="output"></div>
    </div>
    <script>
        document.getElementById('upload').addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                processarDados(json);
            };
            reader.readAsArrayBuffer(file);
        });

        function processarDados(dados) {
            const setores = {
                "MÓVEL": ["N6104793", "N5931955", "N6173067", "N6071740", "N6172207", "F204763"],
                "EMPRESARIAL": ["N6088107", "N5619600", "N0189105", "N5713690", "N5802257", "N5604148", "F201714", "N0125317", "N5819183", "N5926003", "N5932064"],
                "RESIDENCIAL": ["N0238475", "N5923221", "F160641", "N5772086", "N0239871", "N5577565", "N5737414", "N5972428", "N6173055", "N5932090", "N0255801", "N4014011", "N5923996"]
            };

            let resultados = "";
            let headers = dados[0];
            dados.slice(1).forEach(row => {
                let matricula = row[0]?.toString().trim();
                for (const [setor, matriculas] of Object.entries(setores)) {
                    if (matriculas.includes(matricula)) {
                        if (!resultados.includes(setor)) {
                            resultados += `<h3 class='setor'>${setor}</h3>`;
                        }
                        resultados += `<p><strong>Matrícula:</strong> ${matricula} | <strong>Total:</strong> ${row[headers.length - 1]}</p>`;
                    }
                }
            });

            document.getElementById("output").innerHTML = resultados || "Nenhum dado encontrado.";
        }
    </script>
</body>
</html>
